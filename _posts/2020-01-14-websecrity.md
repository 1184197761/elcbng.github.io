---
layout: post
title: 网络组开课之安全知识1
tags: [Websecrity]
author: 404player
---

# 一些简单的网络安全知识




<img src="https://bkimg.cdn.bcebos.com/pic/8644ebf81a4c510f35128e696859252dd52aa5eb@wm_1," alt="404player" style="zoom:25%;" align='left' />

*web安全是一个博大精深的问题，涉及的知识面很广，这节课的主要目的主要还是简略地介绍一下在网站开发中常见web漏洞的原理和一些简单的防御方式。大家压力不要太大，太深的知识不需要大家掌握，当然有兴趣可以自行学习~~~*

### 什么是web？

> web其实就是 World Wide Web 的缩写，也就是我们平时所说的万维网。 它是一种基于超文本和HTTP的、全球性的、动态交互的、跨平台的分布式图形信息系统。是建立在Internet上的一种<b>网络服务</b>，为浏览者在Internet上查找和浏览信息提供了图形化的、易于访问的直观界面 。        	

web在漫长的发展中经历了两个阶段：

|              | web1.0                                  | web2.0                                  |
| :----------: | --------------------------------------- | --------------------------------------- |
|   主要特点   | 只提供静态界面，不能进行增删与修改      | 用户可通过web应用程序与其他用户进行交互 |
|   安全问题   | 主要危害web服务器                       | 主要针对上网的web用户                   |
| 常见安全漏洞 | SQL注入，文件包含，上传漏洞，命令执行等 | 钓鱼，url跳转，XSS，CSRF，逻辑漏洞等    |

### web流程 

主要web流程我口头讲吧

针对web流程的不同阶段，我们可以把常见的安全问题分为前端用户层的问题和后端服务端的问题。

### 浏览器工作原理

也是通过画图呈现

下面通过谷歌浏览器开发者工具的使用向大家展示一下浏览器的工作流程

### web通信

这部分讲两个协议：

- url协议

> url全名为统一资源定位符，主要功能是定义web服务器中所存储的资源，url支持多种协议，且有一定的格式。在安全测试时，测试人员往往要对url进行分析以确定网站是否存在某些类型的安全问题，所以懂得url的格式至关重要。

url标准格式：

``schema://host[:post#]/path/.../[?query-string][#anchor]``

schema为网站的协议类型，如http，https，ftp

host为网站的域名或者IP，如www.baidu.com

port为端口，若是http默认的80端口，浏览器一般省略

path为访问资源的具体路径

？后面的query-string为传入服务器的数据

anchor为锚点，作用是定位到网站的某个区域，一般我们也叫它为网站的哈希

- http协议

跟送快递有一丝相像

方式：Get，Post~~

收获地址：HOST(地址)

快递公司：User-agent

通行证：cookie

response：HTTP 200+正文

给大家抓个包看一看

### 什么是xss漏洞？

>  全名为Cross-site scripting，跨站脚本，为了不和层叠样式表的缩写混淆，通常简称为xss

#### xss的危害：

- 盗取用户信息
- 实现钓鱼
- 制造蠕虫等

本质：是一种html注入，在网页中插入恶意脚本

#### xss 的分类

- 存储型
- 反射性
- Dom型

#### 三种分类的总结

| xss类型  | 存储型                                               | 反射型                       | DOM型                        |
| -------- | ---------------------------------------------------- | ---------------------------- | ---------------------------- |
| 触发过程 | 1.黑客构造恶意脚本   2.用户正常访问携带xss脚本的页面 | 正常用户访问携带xss脚本的URL | 正常用户访问携带xss脚本的URL |
| 数据存储 | 数据库                                               | URL                          | URL                          |
| 输出方式 | 后端WEB应用程序                                      | 后端WEB应用程序              | 前端Javascript               |
| 输出位置 | HTTP响应中                                           | HTTP响应中                   | 动态构造的DOM节点            |

下面用本地搭建的环境给大家演示一下

### 什么是sql注入？

> 在安全防护还不算太强的过去，存在一种密码叫万能密码。使用这种密码不需要输入密码，只需要在用户名处输入admin'--便可以进行登录，思考一下，这种操作的原理是什么呢？

我们思考一下我们输入账号密码时背后的操作，通常是使用http post的方式把用户名和密码提交给服务器，服务器通过php代码获取浏览器提交的密码，（可能会进行md5处理），然后服务器把获取到的用户名和密码拼接到要执行的sql语句中。

下面把拼接的sql语句打印出来看一看：

``select name from teacher where name='admin' and password='md5处理后的密码'``

意思就是从名为teacher表中查询对应用户名，执行成功后返回结果

下面来看一看使用万能密码后执行的sql语句

``select name from teacher where name ='admin'-- passwd='md5加密后的密码'limit 1``

> -- 是起到注释的作用，而前面的单引号则是为了闭合前面的单引号，导致后面的判断语句失效，所以执行的sql语句其实只是``select name from teacher where name='admin'``，当数据库中admin用户存在时，便会返回结果。

所以所谓的万能密码本质上就是sql注入的一种利用方式。

#### 总结一下一次sql注入的过程

1.服务器获取用户请求参数

2.将参数拼接到代码中

3.SQL语句按照我们构造参数的语义执行成功

> sql注入的必备条件：
>
> - 可以控制输入的数据
> - 服务器要执行的代码拼接了控制的数据

本质：数据和代码未分离，即把数据当作代码来执行

ps：凡是用户可控的数据皆为不可信任的数据  

### sql注入的利用和危害

---------------------------------------------------------------

##### 利用

- 利用脚本查询sql版本

``username=admin' and 1=2 union select version() -- &pwd=``

- 获取当前数据库的用户

只需要把version（）改成user（）

---------------------------------------------------------------------------------------------------

危害

- 获取数据库信息
  - 管理员后台用户名和密码
  - 获取其他数据库敏感信息：用户名，密码，手机号码等
  - 整个数据库：脱裤
- 获取服务器权限
- 植入webshell，获取服务器的后门
- 读取服务器敏感文件
- 万能密码











